
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SP - Kamstrup Health Report</title>
  <link rel="manifest" href="manifest.json"/>
  <meta name="theme-color" content="#2c5782"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f4f4f4; margin: 0; padding: 0; color: #2c5782; text-align: center; }
    header { background-color: #2c5782; padding: 12px 20px; color: white; text-align: center; position: fixed; width: 100%; z-index: 1001; top: 0; height: 60px; box-sizing: border-box; }
    header h1 { margin: 0; font-size: 24px; line-height: 1.2; }
    .hamburger { position: fixed; top: 15px; left: 20px; cursor: pointer; z-index: 1002; }
    .hamburger div { width: 25px; height: 3px; background-color: white; margin: 5px 0; transition: all 0.3s ease; }
    .menu-open .hamburger div:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
    .menu-open .hamburger div:nth-child(2) { opacity: 0; }
    .menu-open .hamburger div:nth-child(3) { transform: rotate(-45deg) translate(6px, -6px); }
    .menu { position: fixed; top: 0; left: -250px; width: 250px; height: 100%; background-color: #2c5782; padding-top: 70px; transition: left 0.3s ease; z-index: 1000; }
    .menu-open .menu { left: 0; }
    .menu a { display: block; color: white; padding: 15px 20px; text-decoration: none; font-size: 16px; }
    .menu a:hover { background-color: #1a3a5e; }
    .content { margin-top: 60px; padding: 20px; position: relative; z-index: 1; }
    .report-dates { font-size: 1.15em; margin-bottom: 30px; }
    .region-header { background-color: #dce9f6; padding: 10px; font-size: 2em; font-weight: bold; border-top: 2px solid #2c5782; margin-top: 40px; }
    .performance-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 24px; padding: 20px; }
    .city-card { width: 200px; height: 200px; background: white; border-radius: 16px; box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1); display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 1em; text-align: center; transition: transform 0.3s ease, box-shadow 0.3s ease; }
    .city-card:hover { transform: scale(1.05); box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15); }
    canvas.donut { max-width: 80px; max-height: 80px; margin-top: 8px; display: block; margin-left: auto; margin-right: auto; }
    .collector-box { margin: 20px auto; max-width: 900px; background: #fff; border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); padding: 20px; text-align: center; display: flex; flex-direction: column; justify-content: center; align-items: center; }
    .collector-box h2 { margin-top: 0; }
    .footer-bar { text-align: center; padding: 20px; }
    .footer-bar button { padding: 10px 20px; font-weight: bold; border: 2px solid #2c5782; background: #e0f3ff; cursor: pointer; margin-bottom: 10px; }
    .footer-bar a { display: inline-block; margin-bottom: 10px; text-decoration: none; color: #2c5782; font-size: 0.9em; }
    .blinking-alert { font-size: 1.5em; margin-top: 4px; animation: blink 1s step-start 0s infinite; }
    @keyframes blink { 50% { opacity: 0; } }
    @media print {
      @page { size: landscape; margin: 0.3in; }
      body { zoom: 60%; margin: 0; }
      header, .footer-bar, button, .menu { display: none !important; }
      .performance-container { page-break-inside: avoid; }
      .collector-box, .region-header, .performance-container { break-inside: avoid; }
      #cityModal, #modalBackdrop { display: none !important; }
      .blinking-alert { animation: none !important; opacity: 1 !important; }
    }
  </style>
</head>
<body>
  <div class="hamburger"><div></div><div></div><div></div></div>
  <header><h1>SP - Kamstrup Health Report</h1></header>
  <div class="menu">
    <a href="index.html">Home</a>
    <a href="overview.html">Overview</a>
    <a href="louisiana.html">Louisiana</a>
    <a href="mississippi.html">Mississippi</a>
    <a href="florida.html">Florida</a>
    <a href="new-mexico.html">New Mexico</a>
    <a href="north-carolina.html">North Carolina</a>
    <a href="oregon.html">Oregon</a>
    <a href="south-carolina.html">South Carolina</a>
  </div>
  <div class="content">
    <div class="report-dates" id="report-dates-box">
      Report Date: <span id="report-date"></span><br/>
      Start Date: <span id="start-date"></span><br/>
      End Date: <span id="end-date"></span>
    </div>
    <div class="region-header">Louisiana</div>
    <div class="performance-container" id="louisiana-container"></div>
    <div class="collector-box"><h2>Collector Issues</h2><div id="collector-issues-content-la">Loading...</div></div>
    <div class="region-header">Mississippi</div>
    <div class="performance-container" id="mississippi-container"></div>
    <div class="collector-box"><h2>Collector Issues</h2><div id="collector-issues-content-ms">Loading...</div></div>
    <div class="region-header">Florida</div>
    <div class="performance-container" id="florida-container"></div>
    <div class="collector-box"><h2>Collector Issues</h2><div id="collector-issues-content-fl">Loading...</div></div>
    <div class="region-header">New Mexico</div>
    <div class="performance-container" id="new-mexico-container"></div>
    <div class="collector-box"><h2>Collector Issues</h2><div id="collector-issues-content-nm">Loading...</div></div>
    <div class="region-header">North Carolina</div>
    <div class="performance-container" id="north-carolina-container"></div>
    <div class="collector-box"><h2>Collector Issues</h2><div id="collector-issues-content-nc">Loading...</div></div>
    <div class="region-header">Oregon</div>
    <div class="performance-container" id="oregon-container"></div>
    <div class="collector-box"><h2>Collector Issues</h2><div id="collector-issues-content-or">Loading...</div></div>
    <div class="region-header">South Carolina</div>
    <div class="performance-container" id="south-carolina-container"></div>
    <div class="collector-box"><h2>Collector Issues</h2><div id="collector-issues-content-sc">Loading...</div></div>
    <div class="footer-bar">
      <button onclick="fetchChartData()">Refresh Dashboard Data</button><br/>
      <a href="https://docs.google.com/spreadsheets/d/1ty-vhb5k6FS6InlZp9CcGnwoizEdmyMz-IcPXg67tVU/edit?gid=0#gid=0" target="_blank">Edit Performance Data in Google Sheets</a>
    </div>
  </div>
  <div id="cityModal" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%);
    background:white; padding:20px; border-radius:16px; box-shadow:0 4px 20px rgba(0,0,0,0.3); z-index:1000; width:320px; 
    text-align:center; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; color:#2c5782;">
    <h2 id="modalCityName" style="margin-top:0; font-size:1.6em; font-weight:bold;"></h2>
    <p><strong>Reading Performance:</strong><br/><span id="modalPerformance" style="font-size:1.3em;"></span>%</p>
    <p><strong>Total Meters:</strong><br/><span id="modalTotal"></span></p>
    <p><strong>Missing Reads:</strong><br/><span id="modalMissing"></span></p>
    <button onclick="closeCityModal()" style="margin-top:12px; padding:10px 20px; font-weight:bold; border-radius:8px;
      border: 2px solid #2c5782; background: #e0f3ff; cursor:pointer;">Close</button>
  </div>
  <div id="modalBackdrop" onclick="closeCityModal()" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh;
    background:rgba(0,0,0,0.5); z-index:999;"></div>
  <div style="text-align:center; margin-bottom: 20px;">
    <button onclick="window.print()" style="padding: 10px 20px; font-weight: bold; border: 2px solid #2c5782; background: #e0f3ff; cursor: pointer;">
      Print / Export to PDF
    </button>
  </div>
  <script>
    // JavaScript logic inserted here as needed
  </script>
</body>
</html>
